<Window x:Class="SmartSleep.App.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:models="clr-namespace:SmartSleep.App.Models"
        Title="SmartSleep 설정"
        Width="660"
        Height="780"
        MinWidth="600"
        MinHeight="700"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
            <StackPanel VerticalAlignment="Top">
                <TextBlock Text="현재 상태" FontWeight="Bold" FontSize="14"/>
                <StackPanel Margin="0,8,0,16">
                    <TextBlock Text="{Binding LiveInputStatus}"/>
                    <TextBlock Text="{Binding LiveCpuStatus}" Margin="0,2,0,0"/>
                    <TextBlock Text="{Binding LiveNetworkStatus}" Margin="0,2,0,0"/>
                    <TextBlock Text="{Binding LiveCombinationStatus}" Margin="0,2,0,0"/>
                    <TextBlock Text="{Binding LiveStatusMessage}" Margin="0,4,0,0" Foreground="{Binding LiveStatusBrush}"/>
                </StackPanel>

                <TextBlock Text="모니터링 기준" FontWeight="Bold" FontSize="14"/>
                <StackPanel Margin="0,8,0,16">
                    <CheckBox Content="마우스/키보드 활동 사용" IsChecked="{Binding UseInputActivity}"/>
                    <StackPanel Orientation="Horizontal" Margin="24,4,0,0">
                        <TextBlock Text="입력 유휴 판정 (초):" VerticalAlignment="Center"/>
                        <TextBox Width="80" Margin="8,0,0,0" IsEnabled="{Binding UseInputActivity}" Text="{Binding InputIdleSeconds, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>

                    <CheckBox Content="CPU 활동 사용" IsChecked="{Binding UseCpuActivity}" Margin="0,12,0,0"/>
                    <StackPanel Orientation="Horizontal" Margin="24,4,0,0">
                        <TextBlock Text="CPU 임계값 (%):" VerticalAlignment="Center"/>
                        <TextBox Width="80" Margin="8,0,0,0" IsEnabled="{Binding UseCpuActivity}" Text="{Binding CpuUsageThreshold, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="24,4,0,0">
                        <TextBlock Text="CPU 유휴 필요 시간 (초):" VerticalAlignment="Center"/>
                        <TextBox Width="80" Margin="8,0,0,0" IsEnabled="{Binding UseCpuActivity}" Text="{Binding CpuIdleDurationSeconds, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="24,4,0,0">
                        <TextBlock Text="CPU 이동 평균 샘플 수:" VerticalAlignment="Center"/>
                        <TextBox Width="80" Margin="8,0,0,0" IsEnabled="{Binding UseCpuActivity}" Text="{Binding CpuSmoothingWindow, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>

                    <CheckBox Content="네트워크 활동 사용" IsChecked="{Binding UseNetworkActivity}" Margin="0,12,0,0"/>
                    <StackPanel Orientation="Horizontal" Margin="24,4,0,0">
                        <TextBlock Text="네트워크 임계값 (KB/s):" VerticalAlignment="Center"/>
                        <TextBox Width="80" Margin="8,0,0,0" IsEnabled="{Binding UseNetworkActivity}" Text="{Binding NetworkThreshold, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="24,4,0,0">
                        <TextBlock Text="네트워크 유휴 필요 시간 (초):" VerticalAlignment="Center"/>
                        <TextBox Width="80" Margin="8,0,0,0" IsEnabled="{Binding UseNetworkActivity}" Text="{Binding NetworkIdleDurationSeconds, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="24,4,0,0">
                        <TextBlock Text="네트워크 이동 평균 샘플 수:" VerticalAlignment="Center"/>
                        <TextBox Width="80" Margin="8,0,0,0" IsEnabled="{Binding UseNetworkActivity}" Text="{Binding NetworkSmoothingWindow, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>


                    <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
                        <TextBlock Text="모니터링 주기 (초):" VerticalAlignment="Center"/>
                        <TextBox Width="80" Margin="8,0,0,0" Text="{Binding PollingIntervalSeconds, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>
                </StackPanel>

                <TextBlock Text="감시 시간 설정" FontWeight="Bold" FontSize="14"/>
                <StackPanel Margin="0,8,0,16">
                    <!-- Schedule Mode Selection -->
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                        <TextBlock Text="감시 모드:" VerticalAlignment="Center"/>
                        <ComboBox Width="200" Margin="8,0,0,0" SelectedValuePath="Tag" SelectedValue="{Binding ScheduleMode}">
                            <ComboBoxItem Content="항상 감시" Tag="{x:Static models:ScheduleMode.Always}"/>
                            <ComboBoxItem Content="매일 같은 시간대" Tag="{x:Static models:ScheduleMode.Daily}"/>
                            <ComboBoxItem Content="요일별 세부 설정" Tag="{x:Static models:ScheduleMode.Weekly}"/>
                        </ComboBox>
                    </StackPanel>

                    <!-- Daily Mode Settings -->
                    <StackPanel Margin="0,8,0,0" Visibility="{Binding DailyModeVisible}">
                        <TextBlock Text="매일 감시 시간" FontWeight="SemiBold" Margin="0,0,0,4"/>
                        <StackPanel Orientation="Horizontal" Margin="24,4,0,0">
                            <TextBlock Text="시작 (HH:mm):" VerticalAlignment="Center"/>
                            <TextBox Width="100" Margin="8,0,0,0" Text="{Binding DailyStartText, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="24,4,0,0">
                            <TextBlock Text="종료 (HH:mm):" VerticalAlignment="Center"/>
                            <TextBox Width="100" Margin="8,0,0,0" Text="{Binding DailyEndText, UpdateSourceTrigger=PropertyChanged}"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Weekly Mode Settings -->
                    <StackPanel Margin="0,8,0,0" Visibility="{Binding WeeklyModeVisible}">
                        <TextBlock Text="요일별 감시 시간" FontWeight="SemiBold" Margin="0,0,0,4"/>

                        <!-- Monday -->
                        <Grid Margin="0,4,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="60"/>
                                <ColumnDefinition Width="90"/>
                                <ColumnDefinition Width="80"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="80"/>
                            </Grid.ColumnDefinitions>
                            <CheckBox Grid.Column="0" Content="월요일" IsChecked="{Binding MondayEnabled}"/>
                            <CheckBox Grid.Column="1" Content="24시간" IsChecked="{Binding MondayAllDay}" IsEnabled="{Binding MondayEnabled}"/>
                            <TextBox Grid.Column="2" Width="70" Text="{Binding MondayStartText, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding MondayTimeEnabled}"/>
                            <TextBlock Grid.Column="3" Text=" - " VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            <TextBox Grid.Column="4" Width="70" Text="{Binding MondayEndText, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding MondayTimeEnabled}"/>
                        </Grid>

                        <!-- Tuesday -->
                        <Grid Margin="0,4,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="60"/>
                                <ColumnDefinition Width="90"/>
                                <ColumnDefinition Width="80"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="80"/>
                            </Grid.ColumnDefinitions>
                            <CheckBox Grid.Column="0" Content="화요일" IsChecked="{Binding TuesdayEnabled}"/>
                            <CheckBox Grid.Column="1" Content="24시간" IsChecked="{Binding TuesdayAllDay}" IsEnabled="{Binding TuesdayEnabled}"/>
                            <TextBox Grid.Column="2" Width="70" Text="{Binding TuesdayStartText, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding TuesdayTimeEnabled}"/>
                            <TextBlock Grid.Column="3" Text=" - " VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            <TextBox Grid.Column="4" Width="70" Text="{Binding TuesdayEndText, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding TuesdayTimeEnabled}"/>
                        </Grid>

                        <!-- Wednesday -->
                        <Grid Margin="0,4,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="60"/>
                                <ColumnDefinition Width="90"/>
                                <ColumnDefinition Width="80"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="80"/>
                            </Grid.ColumnDefinitions>
                            <CheckBox Grid.Column="0" Content="수요일" IsChecked="{Binding WednesdayEnabled}"/>
                            <CheckBox Grid.Column="1" Content="24시간" IsChecked="{Binding WednesdayAllDay}" IsEnabled="{Binding WednesdayEnabled}"/>
                            <TextBox Grid.Column="2" Width="70" Text="{Binding WednesdayStartText, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding WednesdayTimeEnabled}"/>
                            <TextBlock Grid.Column="3" Text=" - " VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            <TextBox Grid.Column="4" Width="70" Text="{Binding WednesdayEndText, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding WednesdayTimeEnabled}"/>
                        </Grid>

                        <!-- Thursday -->
                        <Grid Margin="0,4,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="60"/>
                                <ColumnDefinition Width="90"/>
                                <ColumnDefinition Width="80"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="80"/>
                            </Grid.ColumnDefinitions>
                            <CheckBox Grid.Column="0" Content="목요일" IsChecked="{Binding ThursdayEnabled}"/>
                            <CheckBox Grid.Column="1" Content="24시간" IsChecked="{Binding ThursdayAllDay}" IsEnabled="{Binding ThursdayEnabled}"/>
                            <TextBox Grid.Column="2" Width="70" Text="{Binding ThursdayStartText, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding ThursdayTimeEnabled}"/>
                            <TextBlock Grid.Column="3" Text=" - " VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            <TextBox Grid.Column="4" Width="70" Text="{Binding ThursdayEndText, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding ThursdayTimeEnabled}"/>
                        </Grid>

                        <!-- Friday -->
                        <Grid Margin="0,4,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="60"/>
                                <ColumnDefinition Width="90"/>
                                <ColumnDefinition Width="80"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="80"/>
                            </Grid.ColumnDefinitions>
                            <CheckBox Grid.Column="0" Content="금요일" IsChecked="{Binding FridayEnabled}"/>
                            <CheckBox Grid.Column="1" Content="24시간" IsChecked="{Binding FridayAllDay}" IsEnabled="{Binding FridayEnabled}"/>
                            <TextBox Grid.Column="2" Width="70" Text="{Binding FridayStartText, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding FridayTimeEnabled}"/>
                            <TextBlock Grid.Column="3" Text=" - " VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            <TextBox Grid.Column="4" Width="70" Text="{Binding FridayEndText, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding FridayTimeEnabled}"/>
                        </Grid>

                        <!-- Saturday -->
                        <Grid Margin="0,4,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="60"/>
                                <ColumnDefinition Width="90"/>
                                <ColumnDefinition Width="80"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="80"/>
                            </Grid.ColumnDefinitions>
                            <CheckBox Grid.Column="0" Content="토요일" IsChecked="{Binding SaturdayEnabled}"/>
                            <CheckBox Grid.Column="1" Content="24시간" IsChecked="{Binding SaturdayAllDay}" IsEnabled="{Binding SaturdayEnabled}"/>
                            <TextBox Grid.Column="2" Width="70" Text="{Binding SaturdayStartText, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding SaturdayTimeEnabled}"/>
                            <TextBlock Grid.Column="3" Text=" - " VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            <TextBox Grid.Column="4" Width="70" Text="{Binding SaturdayEndText, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding SaturdayTimeEnabled}"/>
                        </Grid>

                        <!-- Sunday -->
                        <Grid Margin="0,4,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="60"/>
                                <ColumnDefinition Width="90"/>
                                <ColumnDefinition Width="80"/>
                                <ColumnDefinition Width="20"/>
                                <ColumnDefinition Width="80"/>
                            </Grid.ColumnDefinitions>
                            <CheckBox Grid.Column="0" Content="일요일" IsChecked="{Binding SundayEnabled}"/>
                            <CheckBox Grid.Column="1" Content="24시간" IsChecked="{Binding SundayAllDay}" IsEnabled="{Binding SundayEnabled}"/>
                            <TextBox Grid.Column="2" Width="70" Text="{Binding SundayStartText, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding SundayTimeEnabled}"/>
                            <TextBlock Grid.Column="3" Text=" - " VerticalAlignment="Center" HorizontalAlignment="Center"/>
                            <TextBox Grid.Column="4" Width="70" Text="{Binding SundayEndText, UpdateSourceTrigger=PropertyChanged}" IsEnabled="{Binding SundayTimeEnabled}"/>
                        </Grid>
                    </StackPanel>
                </StackPanel>

                <TextBlock Text="기타" FontWeight="Bold" FontSize="14"/>
                <StackPanel Margin="0,8,0,16">
                    <CheckBox Content="Windows 시작 시 자동 실행" IsChecked="{Binding StartWithWindows}"/>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>

        <DockPanel Grid.Row="1" Margin="0,12,0,0">
            <TextBlock DockPanel.Dock="Top" Foreground="DarkOrange" TextWrapping="Wrap" Text="{Binding StatusMessage}" Margin="0,0,0,12"/>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="취소" Width="80" Margin="0,0,8,0" Click="Cancel_Click"/>
                <Button Content="적용" Width="80" Margin="0,0,8,0" Click="Apply_Click"/>
                <Button Content="확인" Width="100" Click="Ok_Click"/>
            </StackPanel>
        </DockPanel>
    </Grid>
</Window>
