<Window x:Class="SmartSleep.App.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:models="clr-namespace:SmartSleep.App.Models"
        Title="SmartSleep 설정"
        Width="660"
        Height="780"
        MinWidth="600"
        MinHeight="700"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanResize">
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <ScrollViewer Grid.Row="0" VerticalScrollBarVisibility="Auto">
            <StackPanel VerticalAlignment="Top">
                <TextBlock Text="현재 상태" FontWeight="Bold" FontSize="14"/>
                <StackPanel Margin="0,8,0,16">
                    <TextBlock Text="{Binding LiveInputStatus}"/>
                    <TextBlock Text="{Binding LiveCpuStatus}" Margin="0,2,0,0"/>
                    <TextBlock Text="{Binding LiveNetworkStatus}" Margin="0,2,0,0"/>
                    <TextBlock Text="{Binding LiveCombinationStatus}" Margin="0,2,0,0"/>
                    <TextBlock Text="{Binding LiveStatusMessage}" Margin="0,4,0,0" Foreground="SlateGray"/>
                </StackPanel>

                <TextBlock Text="모니터링 기준" FontWeight="Bold" FontSize="14"/>
                <StackPanel Margin="0,8,0,16">
                    <CheckBox Content="마우스/키보드 활동 사용" IsChecked="{Binding UseInputActivity}"/>
                    <StackPanel Orientation="Horizontal" Margin="24,4,0,0">
                        <TextBlock Text="입력 유휴 판정 (초):" VerticalAlignment="Center"/>
                        <TextBox Width="80" Margin="8,0,0,0" IsEnabled="{Binding UseInputActivity}" Text="{Binding InputIdleSeconds, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>

                    <CheckBox Content="CPU 활동 사용" IsChecked="{Binding UseCpuActivity}" Margin="0,12,0,0"/>
                    <StackPanel Orientation="Horizontal" Margin="24,4,0,0">
                        <TextBlock Text="CPU 임계값 (%):" VerticalAlignment="Center"/>
                        <TextBox Width="80" Margin="8,0,0,0" IsEnabled="{Binding UseCpuActivity}" Text="{Binding CpuUsageThreshold, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="24,4,0,0">
                        <TextBlock Text="CPU 유휴 필요 시간 (초):" VerticalAlignment="Center"/>
                        <TextBox Width="80" Margin="8,0,0,0" IsEnabled="{Binding UseCpuActivity}" Text="{Binding CpuIdleDurationSeconds, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="24,4,0,0">
                        <TextBlock Text="CPU 이동 평균 샘플 수:" VerticalAlignment="Center"/>
                        <TextBox Width="80" Margin="8,0,0,0" IsEnabled="{Binding UseCpuActivity}" Text="{Binding CpuSmoothingWindow, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>

                    <CheckBox Content="네트워크 활동 사용" IsChecked="{Binding UseNetworkActivity}" Margin="0,12,0,0"/>
                    <StackPanel Orientation="Horizontal" Margin="24,4,0,0">
                        <TextBlock Text="네트워크 임계값 (KB/s):" VerticalAlignment="Center"/>
                        <TextBox Width="80" Margin="8,0,0,0" IsEnabled="{Binding UseNetworkActivity}" Text="{Binding NetworkThreshold, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="24,4,0,0">
                        <TextBlock Text="네트워크 유휴 필요 시간 (초):" VerticalAlignment="Center"/>
                        <TextBox Width="80" Margin="8,0,0,0" IsEnabled="{Binding UseNetworkActivity}" Text="{Binding NetworkIdleDurationSeconds, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="24,4,0,0">
                        <TextBlock Text="네트워크 이동 평균 샘플 수:" VerticalAlignment="Center"/>
                        <TextBox Width="80" Margin="8,0,0,0" IsEnabled="{Binding UseNetworkActivity}" Text="{Binding NetworkSmoothingWindow, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
                        <TextBlock Text="조건 결합 방식:" VerticalAlignment="Center"/>
                        <ComboBox Width="240"
                                  Margin="8,0,0,0"
                                  SelectedValuePath="Tag"
                                  SelectedValue="{Binding CombinationMode}">
                            <ComboBoxItem Content="모든 조건 충족 (AND)" Tag="{x:Static models:IdleCombinationMode.All}"/>
                            <ComboBoxItem Content="조건 중 하나 충족 (OR)" Tag="{x:Static models:IdleCombinationMode.Any}"/>
                        </ComboBox>
                    </StackPanel>

                    <StackPanel Orientation="Horizontal" Margin="0,12,0,0">
                        <TextBlock Text="모니터링 주기 (초):" VerticalAlignment="Center"/>
                        <TextBox Width="80" Margin="8,0,0,0" Text="{Binding PollingIntervalSeconds, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>
                </StackPanel>

                <TextBlock Text="감시 시간대" FontWeight="Bold" FontSize="14"/>
                <StackPanel Margin="0,8,0,16">
                    <CheckBox Content="특정 시간에만 감시" IsChecked="{Binding ScheduleEnabled}"/>
                    <StackPanel Orientation="Horizontal" Margin="24,4,0,0">
                        <TextBlock Text="시작 (HH:mm):" VerticalAlignment="Center"/>
                        <TextBox Width="100" Margin="8,0,0,0" IsEnabled="{Binding ScheduleEnabled}" Text="{Binding ScheduleStartText, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="24,4,0,0">
                        <TextBlock Text="종료 (HH:mm):" VerticalAlignment="Center"/>
                        <TextBox Width="100" Margin="8,0,0,0" IsEnabled="{Binding ScheduleEnabled}" Text="{Binding ScheduleEndText, UpdateSourceTrigger=PropertyChanged}"/>
                    </StackPanel>
                </StackPanel>

                <TextBlock Text="기타" FontWeight="Bold" FontSize="14"/>
                <StackPanel Margin="0,8,0,16">
                    <CheckBox Content="Windows 시작 시 자동 실행" IsChecked="{Binding StartWithWindows}"/>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>

        <DockPanel Grid.Row="1" Margin="0,12,0,0">
            <TextBlock DockPanel.Dock="Top" Foreground="DarkOrange" TextWrapping="Wrap" Text="{Binding StatusMessage}" Margin="0,0,0,12"/>
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="취소" Width="80" Margin="0,0,8,0" Click="Cancel_Click"/>
                <Button Content="적용" Width="80" Margin="0,0,8,0" Click="Apply_Click"/>
                <Button Content="확인" Width="100" Click="Ok_Click"/>
            </StackPanel>
        </DockPanel>
    </Grid>
</Window>
